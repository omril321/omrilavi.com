---
import SEO from "../components/SEO.astro";
import Analytics from "../components/Analytics.astro";
import { colors } from "../config/design-tokens";

export interface Props {
  title: string;
  description: string;
  image: string;
  publishDate: string;
}

const { title, description, image, publishDate } = Astro.props;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />

    <SEO title={title} description={description} image={image} type="article" publishDate={publishDate} />

    <Analytics />
  </head>
  <body class="bg-background text-foreground font-sans leading-relaxed">
    <header class="border-b border-gray-700 bg-surface">
      <nav class="max-w-6xl mx-auto p-4 flex items-center justify-between">
        <div class="flex items-center gap-4">
          <img src="/me.png" alt="Omri Lavi" class="w-10 h-10 rounded-full border-2 border-primary/20 shadow-md" />
          <span class="text-white font-medium hidden sm:block">Omri Lavi</span>
        </div>
        <a
          href="/"
          class="inline-flex items-center gap-2 text-primary hover:text-white transition-colors duration-200 font-medium"
        >
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          Home
        </a>
      </nav>
    </header>

    <main class="max-w-4xl mx-auto p-8">
      <article class="bg-white rounded-xl overflow-hidden shadow-2xl">
        <header class="relative">
          <img src={image} alt={title} class="w-full h-64 md:h-80 object-cover" />
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"></div>
          <div class="absolute bottom-0 left-0 right-0 p-8 text-white">
            <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4 leading-tight">
              {title}
            </h1>
            <p class="text-lg md:text-xl text-gray-200 mb-4 leading-relaxed">
              {description}
            </p>
            <time datetime={publishDate} class="text-sm text-gray-300 font-medium bg-black/30 px-3 py-1 rounded-full">
              {publishDate}
            </time>
          </div>
        </header>

        <div
          class="prose prose-lg max-w-3xl mx-auto p-8 md:p-12 prose-gray prose-headings:text-gray-900 prose-a:text-blue-600 prose-strong:text-gray-900 prose-code:text-gray-800 prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:font-mono prose-code:text-sm prose-pre:bg-gray-900 prose-pre:text-gray-100 prose-blockquote:border-blue-500 prose-blockquote:bg-blue-50"
        >
          <slot />
        </div>
      </article>
    </main>

    <style>
      :root {
        --color-background: ${colors.background};
        --color-surface: ${colors.surface};
        --color-foreground: ${colors.foreground};
        --color-muted: ${colors.muted};
        --color-primary: ${colors.primary};
      }

      body {
        background-color: var(--color-background);
        color: var(--color-foreground);
      }

      .mermaid {
        max-width: 100%;
        width: auto;
        height: auto;
        max-height: 500px;
        margin: 2rem 0;
        display: block;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 8px;
        padding: 1rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        overflow: auto;
      }

      @media (max-width: 768px) {
        .mermaid {
          max-height: 350px;
          margin: 1.5rem 0;
          padding: 0.75rem;
        }
      }
      .prose {
        line-height: 1.75;
      }

      .prose img {
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
    </style>
  </body>
</html>
