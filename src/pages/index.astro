---
import { getCollection } from "astro:content";
import { posts } from "../config/posts";
import { ABOUT_ME } from "../config/constants";

// Get local blog posts
const blogPosts = await getCollection("blog");

// Combine local posts and external posts
const allPosts = [
  ...blogPosts.map((post) => ({
    ...post.data,
    slug: post.slug,
    url: `/blog/${post.slug}`,
  })),
  ...posts.map((post) => ({
    ...post,
    slug: post.url,
  })),
].sort((a, b) => {
  const dateA = new Date(a.publishDate);
  const dateB = new Date(b.publishDate);
  return dateB.getTime() - dateA.getTime();
});
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>Omri Lavi - Building Tools for Developers</title>
    <meta name="description" content={ABOUT_ME.description} />
  </head>
  <body>
    <!-- Hero Section -->
    <header class="hero">
      <h1>Omri Lavi</h1>
      <p class="tagline">Building Tools for Developers</p>
      <p class="bio">{ABOUT_ME.short}</p>

      <!-- Social Links -->
      <div class="social-links">
        <a
          href="https://linkedin.com/in/omri-lavi"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="LinkedIn account"
          class="social-link linkedin"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
              d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"
            ></path>
          </svg>
        </a>

        <a
          href="https://github.com/omril321"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="GitHub account"
          class="social-link github"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
              d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
            ></path>
          </svg>
        </a>

        <a
          href="https://dev.to/omril321"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="Dev.To account"
          class="social-link devto"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
              d="M7.42 10.05c-.18-.16-.46-.23-.84-.23H6l.02 2.44.04 2.45.56-.02c.41 0 .63-.07.83-.26.24-.24.26-.36.26-2.2 0-1.91-.02-1.96-.29-2.18zM0 4.94v14.12h24V4.94H0zM8.56 15.3c-.44.58-1.06.77-2.53.77H4.71V8.53h1.4c1.67 0 2.16.18 2.6.9.27.43.29.6.32 2.57.05 2.23-.02 2.73-.47 3.3zm5.09-5.47h-2.47v1.77h1.52v1.28l-.72.04-.75.03v1.77l1.22.03 1.2.04v1.28h-1.6c-1.53 0-1.6-.01-1.87-.3l-.3-.28v-3.16c0-3.02.01-3.18.25-3.48.23-.31.25-.31 1.88-.31h1.64v1.3zm4.68 5.45c-.17.43-.64.79-1 .79-.18 0-.45-.15-.67-.39-.32-.32-.45-.63-.82-2.08l-.9-3.39-.45-1.67h.76c.4 0 .75.02.75.05 0 .06 1.16 4.54 1.26 4.83.04.15.32-.7.73-2.3l.66-2.52.74-.04c.4-.02.73 0 .73.04 0 .14-1.67 6.38-1.8 6.68z"
            ></path>
          </svg>
        </a>

        <a
          href="https://medium.com/@omril321"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="Medium account"
          class="social-link medium"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">
            <path
              d="M1024 704.736V797.736C1018.16 798.3 1012.16 798.588 1006 798.588C896.061 798.588 834.166 707.016 831.497 592.432C831.418 588.002 831.448 583.6 831.546 579.228C831.606 576.501 831.714 573.783 831.852 571.075C831.921 569.628 831.989 568.269 832.098 566.753C832.206 565.236 832.315 563.72 832.443 562.204C836.401 511.613 852.687 466.594 879.568 433.284C896.267 412.606 916.334 396.852 939.09 386.316C959.078 376.253 987.17 370.699 1010.07 370.699H1011.06C1015.4 370.699 1019.71 370.844 1024 371.13V396.717C1019.45 395.47 1014.58 394.801 1009.4 394.715C963.086 395.67 935.486 451.145 932.049 528.007H1024V549.669H929.972L929.942 549.689C925.703 624.579 966.692 687.87 1024 704.736Z"
            ></path>
            <path
              d="M836.115 244.625L836.923 244.448V238.195H672.014L518.891 598.084L365.768 238.195H188.059V244.448L188.857 244.625C218.957 251.419 234.239 261.551 234.239 298.091V725.872C234.239 762.412 218.898 772.544 188.798 779.338L188 779.516V785.788H308.57V779.535L307.773 779.358C277.672 772.564 262.39 762.432 262.39 725.892V322.905L459.093 785.788H470.249L672.683 309.996V736.457C670.104 765.317 654.96 774.228 627.705 780.382L626.897 780.569V786.773H836.923V780.569L836.115 780.382C808.831 774.228 793.322 765.317 790.743 736.457L790.605 298.091H790.743C790.743 261.551 806.024 251.419 836.115 244.625Z"
            ></path>
          </svg>
        </a>

        <a
          href="https://twitter.com/omril321"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="Twitter account"
          class="social-link twitter"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
              d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"
            ></path>
          </svg>
        </a>
      </div>
    </header>

    <!-- Posts Grid -->
    <main>
      <div class="posts-grid">
        {
          allPosts.map((post) => {
            const isExternal = post.url.startsWith("http");
            return (
              <article class="post-card">
                <a
                  href={post.url}
                  class="post-link"
                  target={isExternal ? "_blank" : "_self"}
                  rel={isExternal ? "noopener noreferrer" : ""}
                >
                  <img src={post.image} alt={post.title} class="post-image" />
                  <div class="post-content">
                    <h2>{post.title}</h2>
                    <p class="post-description">{post.description}</p>
                    <div class="post-meta">
                      <time datetime={post.publishDate}>{post.publishDate}</time>
                      {isExternal && <span class="external-badge">External</span>}
                    </div>
                  </div>
                </a>
              </article>
            );
          })
        }
      </div>
    </main>

    <style>
      body {
        font-family: system-ui, sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 0;
        background-color: #1a1a1a;
      }

      /* Hero Section */
      .hero {
        background: #2a2a2a;
        padding: 3rem 2rem;
        text-align: center;
        border-bottom: 1px solid #444;
      }

      .hero h1 {
        font-size: 3.5rem;
        margin: 0 0 0.5rem 0;
        color: #e0e0e0;
      }

      .tagline {
        font-size: 1.4rem;
        color: #4a9eff;
        margin: 0 0 1.5rem 0;
        font-weight: 600;
      }

      .bio {
        font-size: 1.1rem;
        color: #b0b0b0;
        margin: 0 auto 2rem auto;
        max-width: 800px;
        line-height: 1.6;
      }

      /* Social Links */
      .social-links {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 1rem;
        margin-top: 2rem;
      }

      .social-link {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 2.5rem;
        height: 2.5rem;
        padding: 0.5rem;
        border-radius: 50%;
        text-decoration: none;
        transition:
          transform 0.2s ease,
          background-color 0.2s ease;
        background: #3a3a3a;
      }

      .social-link:hover {
        transform: translateY(-2px);
        background: #4a4a4a;
      }

      .social-link svg {
        width: 100%;
        height: 100%;
        fill: #e0e0e0;
      }

      .social-link.linkedin:hover {
        background: #0077b5;
      }
      .social-link.linkedin:hover svg {
        fill: white;
      }

      .social-link.github:hover {
        background: #333;
      }
      .social-link.github:hover svg {
        fill: white;
      }

      .social-link.devto:hover {
        background: #0a0a0a;
      }
      .social-link.devto:hover svg {
        fill: white;
      }

      .social-link.medium:hover {
        background: #00ab6c;
      }
      .social-link.medium:hover svg {
        fill: white;
      }

      .social-link.twitter:hover {
        background: #1da1f2;
      }
      .social-link.twitter:hover svg {
        fill: white;
      }

      /* Posts Grid */
      main {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
        background-color: #1a1a1a;
      }

      .posts-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
        gap: 2rem;
      }

      .post-card {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition:
          transform 0.2s ease,
          box-shadow 0.2s ease;
      }

      .post-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }

      .post-link {
        text-decoration: none;
        color: inherit;
        display: block;
      }

      .post-image {
        width: 100%;
        height: 200px;
        object-fit: cover;
      }

      .post-content {
        padding: 1.5rem;
      }

      .post-content h2 {
        font-size: 1.4rem;
        margin: 0 0 0.5rem 0;
        color: #333;
        line-height: 1.3;
      }

      .post-description {
        color: #666;
        font-size: 0.95rem;
        margin: 0 0 1rem 0;
        line-height: 1.5;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .post-meta {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 0.85rem;
        color: #888;
      }

      .external-badge {
        background: #e1f5fe;
        color: #0277bd;
        padding: 0.2rem 0.6rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 500;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .hero {
          padding: 2rem 1rem;
        }

        .hero h1 {
          font-size: 2.5rem;
        }

        .tagline {
          font-size: 1.2rem;
        }

        .bio {
          font-size: 1rem;
        }

        .social-links {
          gap: 0.75rem;
        }

        .social-link {
          width: 2.2rem;
          height: 2.2rem;
        }

        .posts-grid {
          grid-template-columns: 1fr;
          gap: 1rem;
        }

        main {
          padding: 1rem;
        }
      }

      @media (max-width: 480px) {
        .posts-grid {
          grid-template-columns: 1fr;
        }

        .hero h1 {
          font-size: 2rem;
        }
      }

      /* Tablet specific - 2 columns */
      @media (min-width: 769px) and (max-width: 1024px) {
        .posts-grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      /* Desktop - 3 columns when space allows */
      @media (min-width: 1025px) {
        .posts-grid {
          grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        }
      }
    </style>
  </body>
</html>
